---

# Temporary directory used to sture the keyfiles for LUKS encrypted devices
keyfile_path: '/root/luk_keyfiles'

# Disks that will be worked on. The partitions on these disks will be erased.
disks:
  - '/dev/sda'
  - '/dev/sdb'

# List of dictionaries of partitions that will be created on both disks.
#
# Each entry of the list can contain any parameter that the "parted" module
# for Ansible is able to manage.
#
# See:
# https://docs.ansible.com/ansible/latest/modules/parted_module.html
partitions:
  - name: 'efi'
    part_start: '1MiB'
    part_end: '513MiB'
    part_type: 'primary'
    unit: 'MiB'
    flags: ['esp']
  - name: 'boot'
    part_start: '513MiB'
    part_end: '1025MiB'
    part_type: 'primary'
    unit: 'MiB'
    flags: ['raid']
  - name: 'swap'
    part_start: '1025MiB'
    part_end: '2047MiB'
    part_type: 'primary'
    unit: 'MiB'
    flags: ['raid']
  - name: 'root'
    part_start: '2047MiB'
    part_end: '100%'
    part_type: 'primary'
    unit: 'MiB'
    flags: ['raid']

# List of dictionaries of raid devices that will be set up.
#
# Format:
#
# - name: device name on /dev for the array
#   devices: list of paths to the partitions that will be forming the array
#   level: raid level of the array
#   metadata: metadata level of the array
# - name: another partition
#   ...
raid_arrays:
  - name: 'md0'
    devices: ['/dev/sda2', '/dev/sdb2']
    level: 'raid1'
    metadata: '0.9'
  - name: 'md1'
    devices: ['/dev/sda3', '/dev/sdb3']
    level: 'raid0'
  - name: 'md2'
    devices: ['/dev/sda4', '/dev/sdb4']
    level: 'raid0'

# List of LUKs devices that will be created.
#
# See:
# https://docs.ansible.com/ansible/latest/modules/luks_device_module.html
luks_devices:
  - name: 'LUKS_BOOT'
    device: '/dev/md0'
    keyfile: 'default'
    type: 'luks1'
  - name: 'LUKS_SWAP'
    device: '/dev/md1'
    keyfile: 'default'
  - name: 'LUKS_ROOT'
    device: '/dev/md2'
    keyfile: 'default'

# List of dictionarios of filesystems to create.
#
# Each entry of the list can use any key compatible with the filesystem
# Ansible module.
#
# See:
# https://docs.ansible.com/ansible/latest/modules/filesystem_module.html
filesystems:
  - dev: '/dev/sda1'
    fstype: 'vfat'
    opts: '-F32'
  - dev: '/dev/mapper/LUKS_BOOT'
    fstype: 'ext4'
  - dev: '/dev/mapper/LUKS_SWAP'
    fstype: 'swap'
  - dev: '/dev/mapper/LUKS_ROOT'
    fstype: 'ext4'
